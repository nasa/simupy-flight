<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SimuPy Flight Vehicle Toolkit &mdash; SimuPy Flight  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="NESC Test Cases" href="nesc_test_cases/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> SimuPy Flight
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nesc_test_cases/index.html">NESC Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">SimuPy Flight API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">SimuPy Flight</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>SimuPy Flight Vehicle Toolkit</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="simupy-flight-vehicle-toolkit">
<h1>SimuPy Flight Vehicle Toolkit<a class="headerlink" href="#simupy-flight-vehicle-toolkit" title="Permalink to this heading"></a></h1>
<a class="reference external image-reference" href="https://doi.org/10.21105/joss.04299"><img alt="https://joss.theoj.org/papers/10.21105/joss.04299/status.svg" src="https://joss.theoj.org/papers/10.21105/joss.04299/status.svg" /></a>
<p><a class="reference external" href="https://nasa.github.io/simupy-flight/">Documentation</a></p>
<p>Vehicle flight simulation is an important part of the innovation of aerospace vehicle technology. The NASA Engineering Safety Center (NESC) has identified and addressed the need to verify flight vehicle simulations through their work on the <a class="reference external" href="https://nescacademy.nasa.gov/flightsim/">“Six degree-of-freedom (6-DOF) Flight Simulation Test Cases.”</a> The author was prompted to develop tools that would allow for the rapid implementation of simulations for novel vehicle concepts including hypersonic re-entry vehicles and urban air mobility vehicles.</p>
<p>This software library leverages open source scientific computing tools to implement an efficient simulation framework for flight vehicles in Python. Equations of motion are composed in blocks using the SimuPy library, an open source Python alternative to Simulink, solves the resulting differential equations using SciPy’s wrappers for standard Fortran implementations. Dynamics equations of the inertial state variables for the position, orientation, and their corresponding rates for integration are developed using the SymPy symbolic library and implemented using code generation. Kinematics equations are implemented through symbolic definition and code generation as well as leveraging other open source software that implements useful functions, such as the solutions to the inverse geodesy problem.</p>
<section id="library-design">
<h2>Library Design<a class="headerlink" href="#library-design" title="Permalink to this heading"></a></h2>
<p>The SimuPy Flight Vehicle Toolkit API is designed to prioritize explicit and modular models, to facilitate adherence to best practices from the scientific Python community, and to follow SimuPy design principles. The library provides a <code class="docutils literal notranslate"><span class="pre">Planet</span></code> and <code class="docutils literal notranslate"><span class="pre">Vehicle</span></code> that implement <a class="reference external" href="https://simupy.readthedocs.io/en/latest/api/api.html">SimuPy’s <code class="docutils literal notranslate"><span class="pre">DynamicalSystem</span></code> interface</a>. This API separation was designed to reflect the modeling distinction between the two bodies being simulated. This separation could have been reflected in other ways; indeed within the <code class="docutils literal notranslate"><span class="pre">Planet</span></code> and <code class="docutils literal notranslate"><span class="pre">Vehicle</span></code> classes there is a namespace separation between model components. However, it is often convenient to break SimuPy models into distinct systems when intermediate signals may be used for multiple purposes. In particular, the separation allows easy access to the vehicle’s sensed acceleration which is an important measurement for flight vehicles, particularly entry vehicles. Due to the disciplined modeling approach set out by SimuPy where the output of systems with state are not dependent on the input, a vehicle whose input changed acceleration could not be modeled without separating the <code class="docutils literal notranslate"><span class="pre">Vehicle</span></code>. In the future, convenience functions will provided for common <code class="docutils literal notranslate"><span class="pre">BlockDiagram</span></code> manipulations like connecting guidance, navigation, or control models to reduce the learning curve for new users.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Vehicle</span></code> class provides the state-less dynamics (angular and translational acceleration) of the flight vehicle. It is constructed by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vehicle</span> <span class="o">=</span> <span class="n">Vehicle</span><span class="p">(</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">I_xx</span><span class="p">,</span> <span class="n">I_yy</span><span class="p">,</span> <span class="n">I_zz</span><span class="p">,</span> <span class="n">I_xy</span><span class="p">,</span> <span class="n">I_yz</span><span class="p">,</span> <span class="n">I_xz</span><span class="p">,</span> <span class="n">x_com</span><span class="p">,</span> <span class="n">y_com</span><span class="p">,</span> <span class="n">z_com</span><span class="p">,</span> <span class="c1"># inertia</span>
    <span class="n">base_aero_coeffs</span><span class="p">,</span> <span class="n">x_mrc</span><span class="p">,</span> <span class="n">y_mrc</span><span class="p">,</span> <span class="n">z_mrc</span><span class="p">,</span> <span class="n">S_A</span><span class="p">,</span> <span class="n">a_l</span><span class="p">,</span> <span class="n">b_l</span><span class="p">,</span> <span class="n">c_l</span><span class="p">,</span> <span class="n">d_l</span><span class="p">,</span> <span class="c1"># aero</span>
    <span class="n">input_aero_coeffs</span><span class="p">,</span> <span class="n">input_force_moment</span><span class="p">,</span> <span class="c1"># extra callbacks for control modeling</span>
    <span class="n">input_aero_coeffs_idx</span><span class="p">,</span> <span class="n">input_force_moment_idx</span><span class="p">,</span> <span class="c1"># routing for control callbacks</span>
    <span class="n">dim_extra_input</span><span class="p">,</span> <span class="c1"># total number of extra (control) inputs</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Planet</span></code> class provides the kinematic equations of motion used to drive the position,  orientation, and their corresponding rates based on the dynamics modeled by the <code class="docutils literal notranslate"><span class="pre">Vehicle</span></code>. The <code class="docutils literal notranslate"><span class="pre">Planet</span></code> is constructed by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">planet</span> <span class="o">=</span> <span class="n">Planet</span><span class="p">(</span><span class="n">gravity</span><span class="p">,</span> <span class="n">winds</span><span class="p">,</span> <span class="n">atmosphere</span><span class="p">,</span> <span class="n">planetodetics</span><span class="p">)</span>
</pre></div>
</div>
<p>For more details, see the docstrings (via <code class="docutils literal notranslate"><span class="pre">help(Vehicle)</span></code> and <code class="docutils literal notranslate"><span class="pre">help(Planet)</span></code> respectively) and NESC Test Case examples.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>To install, clone the repository and install with pip</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/nasa/simupy-flight.git
$ <span class="nb">cd</span> simupy-flight/
$ pip install .
</pre></div>
</div>
</section>
<section id="nesc-test-cases">
<h2>NESC Test Cases<a class="headerlink" href="#nesc-test-cases" title="Permalink to this heading"></a></h2>
<p>A number of the <a class="reference external" href="https://nescacademy.nasa.gov/flightsim">NESC Atmospheric test cases</a> have been implemented to verify the implementation and derivation of the equations of motion. These are located in the <code class="docutils literal notranslate"><span class="pre">nesc_test_cases</span></code> directory. The implementations and their outputs can also be viewed in <a class="reference external" href="https://nasa.github.io/simupy-flight/nesc_test_cases/index.html">the example gallery</a> in the documentation. Additional information about each test case can be found in <a class="reference external" href="https://ntrs.nasa.gov/citations/20150001263">the appendices of the NESC report</a>.</p>
<p>Running the examples requires a few extra dependencies. They can be be installed with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install .<span class="o">[</span>test<span class="o">]</span>
</pre></div>
</div>
<p>To run an example, simply execute any of the <code class="docutils literal notranslate"><span class="pre">nesc_case##.py</span></code> files or the <code class="docutils literal notranslate"><span class="pre">run_nesc_cases.py</span></code> script, which will iterate through test cases that have been implemented. These scripts load the NESC reference results from the <code class="docutils literal notranslate"><span class="pre">NESC_data/</span></code> directory and plot them along with the results from the SimuPy Flight implementation. The reference results are included in the SimuPy Flight repository, but they can be obtained directly from the NESC <a class="reference external" href="https://nescacademy.nasa.gov/src/flightsim/Datasets/Atmospheric_checkcases.zip">here</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The generated code performs a divide by zero if the velocity is zero,
generating <code class="docutils literal notranslate"><span class="pre">RuntimeWarning</span></code>s. However, this condition is checked and
handled correctly.</p>
</div>
<p>The SimuPy Flight results from running all NESC test cases are also included in the repository. By default, running any or all of the tests cases will perform a regression test against this data and report the result(s).</p>
<p>To re-generate the regression data, pass the <code class="docutils literal notranslate"><span class="pre">--write-regression-data</span></code> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python nesc_test_cases/run_nesc_cases.py --write-regression-data
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">-h</span></code> or <code class="docutils literal notranslate"><span class="pre">--help</span></code> to see additional options that can be passed to the test case scripts.</p>
<p>Every case is annotated with at least a basic description adapted from the NESC reports. Cases 1-3 have moderate annotations to highlight basic API usage and modeling approaches. <a class="reference external" href="https://nasa.github.io/simupy-flight/nesc_test_cases/nesc_case11.html#sphx-glr-nesc-test-cases-nesc-case11-py">Case 11</a>, which demonstrates the trimming and straight and level flight of an F-16 model, is thoroughly annotated to illustrate how this simulation framework can be used for a sophisticated simulation. The F-16 vehicle model itself is also thoroughly annotated because it highlights how the <code class="docutils literal notranslate"><span class="pre">Vehicle</span></code> API can be adapted to alternate modeling approaches like the one used for the F-16 model implementation provided by the NESC.</p>
</section>
<section id="daveml-parsing">
<h2>DaveML Parsing<a class="headerlink" href="#daveml-parsing" title="Permalink to this heading"></a></h2>
<p>The American Institute of Aeronautics and Astronautics (AIAA) has developed a XML exchange format for aircraft simulation flight dynamics models called the <a class="reference external" href="https://daveml.org/">Dynamic Aerospace Vehicle Exchange Markup Language (DAVE-ML)</a>. The <code class="docutils literal notranslate"><span class="pre">parse_daveml</span></code> submodule implements a parser that can be used to generate python code from valid DaveML. To use it, call the <code class="docutils literal notranslate"><span class="pre">ProcessDaveML</span></code> with a filename to the DaveML file. A python file will be created in the working directory with the same base-name as the DaveML file (replacing the extension, if any, with <code class="docutils literal notranslate"><span class="pre">.py</span></code>). This feature was used to generate the vehicle models for the NESC test cases using the <code class="docutils literal notranslate"><span class="pre">nesc_test_cases/process_NESC_DaveML.py</span></code> script.</p>
<p>The DaveML specification includes elements for check-case data sets to assist in verification and debugging. The parser adds a function to each generated file, called <code class="docutils literal notranslate"><span class="pre">run_checks</span></code>, which is executed when the file is run as a script. The NESC-provided F16 models include such data sets so they can be checked by running the generated files themselves. For example, to check the F16 aerodynamics model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python nesc_test_cases/F16_aero.py
All checks for F16_aero passed.
</pre></div>
</div>
</section>
<section id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this heading"></a></h2>
<p>Please feel free to share any thoughts or opinions about the design and
implementation of this software by <a class="reference external" href="https://github.com/nasa/simupy-flight/issues/new">opening an issue on GitHub</a>. Constructive feedback is
welcomed and appreciated.</p>
<p>Bug fix pull requests are always welcome. For feature additions, breaking
changes, etc. check if there is an open issue discussing the change and
reference it in the pull request. If there isn’t one, it is recommended to open
one with your rationale for the change before spending significant time
preparing the pull request.</p>
<p>Ideally, new/changed functionality should come with tests and documentation. If
you are new to contributing, it is perfectly fine to open a work-in-progress
pull request and have it iteratively reviewed.</p>
<p>For pull requests to be accepted, all contributors must have a contributor’s agreement on file with NASA. We will provide contributors with additional information during the review process.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this heading"></a></h2>
<p>This software is released under the <a class="reference external" href="https://github.com/nasa/simupy-flight/raw/master/license.pdf">NASA Open Source Agreement Version 1.3</a>.</p>
</section>
<section id="notices">
<h2>Notices<a class="headerlink" href="#notices" title="Permalink to this heading"></a></h2>
<p>Copyright © 2021 United States Government as represented by the Administrator of the National Aeronautics and Space Administration.  All Rights Reserved.</p>
</section>
<section id="disclaimers">
<h2>Disclaimers<a class="headerlink" href="#disclaimers" title="Permalink to this heading"></a></h2>
<p>No Warranty: THE SUBJECT SOFTWARE IS PROVIDED “AS IS” WITHOUT ANY WARRANTY OF ANY KIND, EITHER EXPRESSED, IMPLIED, OR STATUTORY, INCLUDING, BUT NOT LIMITED TO, ANY WARRANTY THAT THE SUBJECT SOFTWARE WILL CONFORM TO SPECIFICATIONS, ANY IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR FREEDOM FROM INFRINGEMENT, ANY WARRANTY THAT THE SUBJECT SOFTWARE WILL BE ERROR FREE, OR ANY WARRANTY THAT DOCUMENTATION, IF PROVIDED, WILL CONFORM TO THE SUBJECT SOFTWARE. THIS AGREEMENT DOES NOT, IN ANY MANNER, CONSTITUTE AN ENDORSEMENT BY GOVERNMENT AGENCY OR ANY PRIOR RECIPIENT OF ANY RESULTS, RESULTING DESIGNS, HARDWARE, SOFTWARE PRODUCTS OR ANY OTHER APPLICATIONS RESULTING FROM USE OF THE SUBJECT SOFTWARE.  FURTHER, GOVERNMENT AGENCY DISCLAIMS ALL WARRANTIES AND LIABILITIES REGARDING THIRD-PARTY SOFTWARE, IF PRESENT IN THE ORIGINAL SOFTWARE, AND DISTRIBUTES IT “AS IS.”</p>
<p>Waiver and Indemnity:  RECIPIENT AGREES TO WAIVE ANY AND ALL CLAIMS AGAINST THE UNITED STATES GOVERNMENT, ITS CONTRACTORS AND SUBCONTRACTORS, AS WELL AS ANY PRIOR RECIPIENT.  IF RECIPIENT’S USE OF THE SUBJECT SOFTWARE RESULTS IN ANY LIABILITIES, DEMANDS, DAMAGES, EXPENSES OR LOSSES ARISING FROM SUCH USE, INCLUDING ANY DAMAGES FROM PRODUCTS BASED ON, OR RESULTING FROM, RECIPIENT’S USE OF THE SUBJECT SOFTWARE, RECIPIENT SHALL INDEMNIFY AND HOLD HARMLESS THE UNITED STATES GOVERNMENT, ITS CONTRACTORS AND SUBCONTRACTORS, AS WELL AS ANY PRIOR RECIPIENT, TO THE EXTENT PERMITTED BY LAW.  RECIPIENT’S SOLE REMEDY FOR ANY SUCH MATTER SHALL BE THE IMMEDIATE, UNILATERAL TERMINATION OF THIS AGREEMENT.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nesc_test_cases/index.html">NESC Test Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">SimuPy Flight API</a></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nesc_test_cases/index.html" class="btn btn-neutral float-right" title="NESC Test Cases" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Benjamin W. L. Margolis.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>